window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}());var ethon={};ethon.engine=function(){function o(n,r,i){e=ethon.render_manager,e.init(n,r,i),t=ethon.input_manager,t.init(n)}function u(e,r){if(typeof r.init!="function"||typeof r.render!="function"||typeof r.update!="function")throw TypeError("scene given doesn't have init, render and update functions");r.input_manager=t,n[e]=r,r.init()}function a(e){r=n[e]}function f(){return r}function l(){requestAnimationFrame(c),s=!0}function c(){h(),p(),requestAnimationFrame(c)}function h(){e.clear(),r.render(e)}function p(){var e=new Date,t=(new Date(e.getTime()-i.getTime())).getMilliseconds()/1e3;r.update(t),i=e}function d(){return s}var e={},t={},n={},r=null,i=new Date,s=!1;return{init:o,scenes:n,addScene:u,setActiveScene:a,getActiveScene:f,start:l,isRunning:d}}(),ethon.render_manager=function(){function o(o,u,a){if(!(o instanceof HTMLCanvasElement))throw new TypeError("init must receive a HTMLCanvasElement");s=!1,e=o,e.width=u,e.height=a,t=e.getContext("2d"),n="#000000",r="#000000",i=1}function u(){t.clearRect(0,0,e.width,e.height)}function a(e){e.fillStyle!==undefined&&(n=e.fillStyle),e.strokeStyle!==undefined&&(r=e.strokeStyle),e.lineWidth!==undefined&&(i=e.lineWidth)}function f(){return{fillStyle:n,strokeStyle:r,lineWidth:i}}function l(){return e.width}function c(){return e.height}function h(e){t.save(),t.translate(e.x,e.y),e.rotate!=undefined&&e.rotate!=0&&(t.translate(e.width/2,e.height/2),t.rotate(e.rotate*(Math.PI/180)),t.translate(-e.width/2,-e.height/2)),e.scale!=undefined&&t.scale(e.scale[0],e.scale[1]),e.fillStyle!=undefined?t.fillStyle=e.fillStyle:t.fillStyle=n,e.strokeStyle!=undefined?t.strokeStyle=e.strokeStyle:t.strokeStyle=r,e.lineWidth!=undefined?t.lineWidth=e.lineWidth:t.lineWidth=i}function p(){t.restore()}function d(e,t){this.beginDrawContext(e),t(),this.endDrawContext()}function v(e,n,r,i,s){s==undefined&&(s={}),s.x=e,s.y=n,s.width=Math.abs(r-e),s.height=Math.abs(i-n),this.onDrawContext(s,function(){t.beginPath(),t.moveTo(0,0),t.lineTo(r-e,i-n),t.stroke()})}function m(e,n,r,i,o){o==undefined&&(o={}),o.x=e,o.y=n,o.width=r,o.height=i;var u=this;this.onDrawContext(o,function(){t.fillRect(0,0,r,i),s&&y.call(u,r,i)})}function g(e,n,r,i){i==undefined&&(i={}),i.x=e,i.y=n;var o=this;this.onDrawContext(i,function(){t.beginPath(),t.arc(0,0,r,0,2*Math.PI,!0),t.stroke(),t.fill(),s&&y.call(o,r*2,r*2)})}function y(e,t){this.drawLine(0,0,e+10,0,{strokeStyle:"#ff0000",lineWidth:2}),this.drawLine(0,0,0,t+10,{strokeStyle:"#00ff00",lineWidth:2})}function b(e,n,r,i){i==undefined&&(i={}),i.x=n,i.y=r,i.width=e.width,i.height=e.height;if(!(e instanceof Image))throw new TypeError("drawImage must receive an Image");var o=this;this.onDrawContext(i,function(){t.drawImage(e,0,0),s&&y.call(o,e.width,e.height)})}var e,t,n,r,i,s;return{init:o,clear:u,setDefaultStyle:a,getDefaultStyle:f,getCanvasWidth:l,getCanvasHeight:c,beginDrawContext:h,endDrawContext:p,onDrawContext:d,drawLine:v,drawBox:m,drawCircle:g,drawImage:b}}(),ethon.input_manager=function(){function n(e){if(!(e instanceof HTMLCanvasElement))throw new TypeError("init must receive a HTMLCanvasElement");e=e,t=new Array(256);for(var n=0;n<256;n++)t[n]=0;document.body.addEventListener("keydown",r),document.body.addEventListener("keyup",i),e.addEventListener("mousedown",u)}function r(e){t[e.keyCode]=1}function i(e){t[e.keyCode]=0}function s(e){return t[e]==1}function o(e){return t[e]==0}function u(e){}var e,t;return{init:n,isKeyDown:s,isKeyUp:o,KEY_A:65,KEY_B:66,KEY_SPACEBAR:32,KEY_LEFT_ARROW:37,KEY_RIGHT_ARROW:39,KEY_UP_ARROW:38}}();