<html>
  <head>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="../src/request_animation_frame.js"></script>
    <script type="text/javascript" src="../src/ethon.js"></script>
    <script type="text/javascript" src="../src/engine.js"></script>
    <script type="text/javascript" src="../src/render_manager.js"></script>
    <script type="text/javascript" src="../src/input_manager.js"></script>
    <script type="text/javascript">
      $(function() {
        var canvas_1 = document.getElementById('test_1');
        var scene = {
          ball: {
            x: 100,
            y: 100,
            radius: 10,
            vx: 200,
            vy: 300,
            render: function(rm) {
              rm.drawCircle(this.x, this.y, this.radius);
            },
            update: function(paddle, im, dt) {
              this.x += this.vx * dt; 
              this.y += this.vy * dt; 

              if(this.x + 10 > 500 || this.x < 0) { this.vx = -this.vx }
              if(this.y + 10 > 500 || this.y < 0) { this.vy = -this.vy }

              if((this.y + this.radius / 2) > paddle.y &&
                this.x > paddle.x && this.x < paddle.x + 100) {
                this.vy = -this.vy;
                this.vx = Math.floor(-Math.random()*401 + Math.random()*401)
              }
            }
          },
          paddle: {
            x: 200,
            y: 450,
            render: function(rm) {
              rm.drawBox(this.x, this.y, 100, 10);
            },
            update: function(im, dt) {
              if(im.isKeyDown(ethon.input_manager.KEY_LEFT_ARROW) && this.x > 0) { 
                this.x -= 200 * dt; 
              }
              else if(im.isKeyDown(ethon.input_manager.KEY_RIGHT_ARROW) && this.x < 500 - 100) { 
                this.x += 200 * dt; 
              }
            }
          },
          render: function(rm) {
            this.paddle.render(rm);
            this.ball.render(rm);
          },
          update: function(dt) {
            var im = this.input_manager;
            this.paddle.update(im, dt);
            this.ball.update(this.paddle, im, dt);
          }
        };
        var engine = ethon.engine;
        engine.init(canvas_1);
        engine.addScene("main", scene);
        engine.setActiveScene("main");
        engine.start();
      });
    </script>
  </head>
  <body>
    <div style="float: left; width: 600px; display: inline">
      <h2>Test 1</h2>
      <canvas id="test_1" style="border: 1px solid #000"></canvas>
    </div>
  </body>
</html>
